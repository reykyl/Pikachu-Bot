let handler = async (m, { conn }) => {
  try {
    let id = m.chat;
    let tipo = id.endsWith('@g.us') ? 'Grupo' : id.endsWith('@newsletter') ? 'Canal' : id.endsWith('@s.whatsapp.net') ? 'Chat Privado' : 'Desconocido';
    let nombre = await conn.getName(id);
    let participantes = [];
    let descripcion = '';
    
    if (tipo === 'Grupo') {
      const info = await conn.groupMetadata(id);
      participantes = info.participants.map(p => p.id);
      descripcion = info.desc || 'Sin descripciÃ³n';
    } else if (tipo === 'Canal') {
      descripcion = 'Canal de WhatsApp (newsletter)';
    }

    let texto = `â”Œâ”€ âŸ¡ *INSPECCIÃ“N DE CHAT*\nâ”‚\nâ”‚ ğŸ“Œ *Tipo:* ${tipo}\nâ”‚ ğŸ†” *ID:* ${id}\nâ”‚ ğŸ“› *Nombre:* ${nombre}\nâ”‚ ğŸ‘¥ *Participantes:* ${participantes.length || 'N/A'}\nâ”‚ ğŸ“ *DescripciÃ³n:* ${descripcion.slice(0, 100)}${descripcion.length > 100 ? '...' : ''}\nâ”‚\nâ””â”€â”€â”€â”€âŸ¡`;

    await m.reply(texto);
  } catch (e) {
    console.error(e);
    await m.reply('âŒ Error al inspeccionar este chat. AsegÃºrate de que el bot estÃ© dentro del grupo o canal.');
  }
};

handler.help = ['inspeccionar'];
handler.tags = ['tools'];
handler.command = ['inspeccionar', 'id', 'chatinfo'];
handler.rowner = true; // Opcional: solo dueÃ±o

export default handler;